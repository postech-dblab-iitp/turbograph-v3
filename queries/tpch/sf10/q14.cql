MATCH (item: LINEITEM)-[:COMPOSED_BY]->(part: PART)
WHERE item.L_SHIPDATE >= date('1995-06-01') 
    AND item.L_SHIPDATE < date('1995-07-01')
WITH
    SUM(CASE WHEN part.P_TYPE CONTAINS 'PROMO'
        THEN item.L_EXTENDEDPRICE * (1.0 - item.L_DISCOUNT) 
        ELSE 0.0 END) AS PROMO_REVENUE1,
    SUM(item.L_EXTENDEDPRICE * (1 - item.L_DISCOUNT)) AS PROMO_REVENUE2
RETURN
    100 * PROMO_REVENUE1 / PROMO_REVENUE2 AS PROMO_REVENUE;